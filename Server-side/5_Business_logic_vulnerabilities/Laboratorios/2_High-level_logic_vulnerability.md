# Lab: High-level logic vulnerability

This lab doesn't adequately validate user input. You can exploit a logic flaw in its purchasing workflow to buy items for an unintended price. To solve the lab, buy a "Lightweight l33t leather jacket".

You can log in to your own account using the following credentials: `wiener:peter`

![Practitioner](https://img.shields.io/badge/level-Apprentice-green)  

---

Iniciamos el laboratorio y tenemos una aplicación para hacer compras:
![image](https://github.com/user-attachments/assets/bd1c8c1c-44ea-497e-b431-feb5d61aaf68)

Accedemos al panel de login usando el botón `My account` e iniciamos sesión con nuestras credenciales:
![image](https://github.com/user-attachments/assets/84a9859b-2751-4922-aba7-beb0fe37b181)

En nuestro dashboard, vemos que tenemos disponibles $100 para hacer compras:
![image](https://github.com/user-attachments/assets/66342365-edac-4430-bcee-38bb4c9f8f82)

Hacemos click en `home` y vemos que la chaqueta tiene un precio más elevado que nuestro presupuesto:
![image](https://github.com/user-attachments/assets/1f059599-44dd-4cfd-9b68-09d91d570e8a)


Interceptamos con `Burp Suite` para analizar el flujo, primero hacemos click en `View details`:
![image](https://github.com/user-attachments/assets/e8e1610c-ad0e-453e-a183-9eba049dd3c0)
![image](https://github.com/user-attachments/assets/12a54f4e-55ff-4d74-a1a4-8730d78f6b99)

Luego añadimos al carrito:
![image](https://github.com/user-attachments/assets/f9db3926-9cea-44de-900c-36eafa183791)

Esta es una petición `POST` que tramita los parámetros `productId=1&redir=PRODUCT&quantity=1`, esto quiere decir que agregamos al carrito el `productId=1`, nos redirije a la página del producto (respuesta `302, Location: /product?productId=1`) y solicitamos la cantidad de 1 producto.

Luego hacemos click en el carrito para dirigirnos al dashboard `/cart`:
![image](https://github.com/user-attachments/assets/04b3d0cb-0815-4e2b-bd25-cf092abf3fc0)

Petición en `Burp Suite`:
![image](https://github.com/user-attachments/assets/239d2030-ecba-4552-ab58-2b18c186bcd3)








